---
title: "Process_Data"
author: "czx"
date: "`r Sys.Date()`"
output: html_document
---

# Process Coding
## Loading package
```{r Package, warning = FALSE,message = FALSE}
# clean data
library(tidyr)
library(dplyr)
library(stringr)
library(effsize)
```

# Initial Data.Frame List
## Identity：self,close,stranger,non-person,celebrity,acquaintance
```{r Data.Frame List}
df <- list()

df_Self_Stranger <- list()
df_Self_Close <- list()
df_Self_Acquaintance <- list()
df_Self_Celebrity <- list()
df_Self_Non_Person <- list()
```


# Darw picture
```{r}
# 加载ggplot2包
library(ggplot2)

# 创建数据框
data <- data.frame(
  Category = c("Cognitive", "Memory", "Motor", "Multiple", "Exception"),
  n = c(16, 27, 3, 10, 89)
)

# 为渐变创建一个连续变量
data$value <- seq_along(data$n)

# 定义颜色向量
colors <- c("Cognitive" = "#FF0000", "Memory" = "#FF7F00", "Motor" = "#FFFF00",
            "Multiple" = "#FFFF00", "Exception" = "#FFFF00")

# 创建饼图
ggplot(data, aes(x = "", y = n, fill = Category)) +
  geom_bar(width = 1, stat = "Origin_Identity") +
  coord_polar("y", start = 0) +
  scale_fill_manual(values = colors) + # 使用自定义颜色
  theme_void() + # 使用主题void来隐藏轴和背景
  labs(fill = "Category", title = "Proportion of Categories") +
  theme(legend.position = "right") # 调整图例位置

rm(colors)
```

# GPT4
```{r}
# 加载必要的库
library(dplyr)
library(ggplot2)

# 假设 df 是一个包含文章数据的列表，其中每个元素都是一个数据框
# df 是一个列表，df[[n]] 是第 n 篇文章，里面包含数据

# 定义一些变量来存储统计信息
all_data <- data.frame()  # 用于存储所有文章的人口统计学和 RT 数据
gender_count <- 0  # 存储性别的数量信息
age_data <- c()  # 存储所有年龄信息

# 遍历每篇文章的数据
for (i in 1:length(df)) {
  article_data <- df[[i]]  # 获取每篇文章的数据
  
  # 只选择我们关心的列，如 Gender、Age 和 RT_ms，其他的列忽略
  article_data_filtered <- article_data %>%
    select(any_of(c("Gender", "Age", "RT_ms")))  # 只选择这些列，如果不存在则忽略
  
  # 确保 Age 列统一为数值类型，如果无法转换则设为 NA
  if ("Age" %in% colnames(article_data_filtered)) {
    article_data_filtered$Age <- as.numeric(as.character(article_data_filtered$Age))
  }
  
  # 确保合并时类型一致，比如 Gender 和 Age 列
  if ("Gender" %in% colnames(article_data_filtered)) {
    # 如果包含 Gender 列，则统计性别
    gender_count <- gender_count + table(article_data_filtered$Gender)
  }
  
  if ("Age" %in% colnames(article_data_filtered)) {
    # 如果包含 Age 列，则收集年龄信息
    age_data <- c(age_data, article_data_filtered$Age)
  }
  
  # 将每篇文章的数据合并，只合并过滤后的数据
  all_data <- bind_rows(all_data, article_data_filtered)
}

# 人口统计学描述
total_subjects <- nrow(all_data)  # 被试总人数
male_count <- sum(all_data$Gender == "Male", na.rm = TRUE)  # 男性数量
female_count <- sum(all_data$Gender == "Female", na.rm = TRUE)  # 女性数量
avg_age <- mean(age_data, na.rm = TRUE)  # 平均年龄

# 输出人口统计学信息
cat("总被试量: ", total_subjects, "\n")
cat("男性数量: ", male_count, "\n")
cat("女性数量: ", female_count, "\n")
cat("平均年龄: ", avg_age, "\n")

# 对被试量进行分组
subject_bins <- cut(total_subjects, breaks = c(1, 10, 20, 40, 80, 160, Inf),
                    labels = c("1-10", "11-20", "21-40", "41-80", "81-160", "160以上"))

# 计算每个区间的被试数量
subject_distribution <- table(subject_bins)

# 将被试量数据转换为数据框
subject_df <- as.data.frame(subject_distribution)
colnames(subject_df) <- c("Range", "Count")

# 画出被试量比例的饼图
ggplot(subject_df, aes(x = "", y = Count, fill = Range)) +
  geom_bar(stat = "Origin_Identity", width = 1) +
  coord_polar("y", start = 0) +
  scale_fill_manual(values = colorRampPalette(c("yellow", "red"))(6)) +
  labs(title = "被试量分布比例") +
  theme_void()

# 如果有 RT_ms 数据，对其进行统计
if ("RT_ms" %in% colnames(all_data)) {
  rt_summary <- summary(all_data$RT_ms)
  cat("RT_ms 描述统计: \n")
  print(rt_summary)
}

rm(all_data,article_data_filtered,article_data)
```

# GPT3.5
## v1
```{r}
# 加载必要的库
library(dplyr)
library(ggplot2)

# 假设 df 是一个包含文章数据的列表，其中每个元素都是一个数据框
# df 是一个列表，df[[n]] 是第 n 篇文章，里面包含数据

# 定义一些变量来存储统计信息
all_data <- data.frame()  # 用于存储所有文章的人口统计学和 RT 数据
gender_count_list <- list()  # 存储每篇文章的性别统计信息
age_data <- c()  # 存储所有年龄信息

# 遍历每篇文章的数据
for (i in 1:length(df)) {
  article_data <- df[[i]]  # 获取每篇文章的数据
  
  # 只选择我们关心的列，如 Gender、Age 和 RT_ms，其他的列忽略
  article_data_filtered <- article_data %>%
    select(any_of(c("Gender", "Age", "RT_ms")))  # 只选择这些列，如果不存在则忽略
  
  # 确保 Gender 列为字符类型，Age 列统一为数值类型
  if ("Gender" %in% colnames(article_data_filtered)) {
    article_data_filtered$Gender <- as.character(article_data_filtered$Gender)
  }
  
  if ("Age" %in% colnames(article_data_filtered)) {
    article_data_filtered$Age <- as.numeric(as.character(article_data_filtered$Age))
  }
  
  # 统计性别
  if ("Gender" %in% colnames(article_data_filtered)) {
    current_gender_count <- table(article_data_filtered$Gender)
    gender_count_list[[i]] <- current_gender_count
  }
  
  # 收集年龄数据
  if ("Age" %in% colnames(article_data_filtered)) {
    age_data <- c(age_data, article_data_filtered$Age)
  }
  
  # 将每篇文章的数据合并，只合并过滤后的数据
  all_data <- bind_rows(all_data, article_data_filtered)
}

# 合并所有文章的性别统计
gender_count <- Reduce(`+`, gender_count_list, init = table(factor(levels = unique(unlist(lapply(gender_count_list, names))))))

# 人口统计学描述
total_subjects <- nrow(all_data)  # 被试总人数
male_count <- sum(all_data$Gender == "Male", na.rm = TRUE)  # 男性数量
female_count <- sum(all_data$Gender == "Female", na.rm = TRUE)  # 女性数量
avg_age <- mean(age_data, na.rm = TRUE)  # 平均年龄

# 输出人口统计学信息
cat("总被试量: ", total_subjects, "\n")
cat("男性数量: ", male_count, "\n")
cat("女性数量: ", female_count, "\n")
cat("平均年龄: ", avg_age, "\n")

# 对被试量进行分组
subject_bins <- cut(total_subjects, breaks = c(1, 10, 20, 40, 80, 160, Inf),
                    labels = c("1-10", "11-20", "21-40", "41-80", "81-160", "160以上"))

# 计算每个区间的被试数量
subject_distribution <- table(subject_bins)

# 将被试量数据转换为数据框
subject_df <- as.data.frame(subject_distribution)
colnames(subject_df) <- c("Range", "Count")

# 画出被试量比例的饼图
ggplot(subject_df, aes(x = "", y = Count, fill = Range)) +
  geom_bar(stat = "Origin_Identity", width = 1) +
  coord_polar("y", start = 0) +
  scale_fill_manual(values = colorRampPalette(c("yellow", "red"))(6)) +
  labs(title = "被试量分布比例") +
  theme_void()

# 如果有 RT_ms 数据，对其进行统计
if ("RT_ms" %in% colnames(all_data)) {
  rt_summary <- summary(all_data$RT_ms)
  cat("RT_ms 描述统计: \n")
  print(rt_summary)
}


```

## v2
```{r}
# 加载必要的库
library(dplyr)
library(ggplot2)

# 假设 df 是一个包含文章数据的列表，其中每个元素都是一个数据框
# df 是一个列表，df[[n]] 是第 n 篇文章，里面包含数据

# 定义一些变量来存储统计信息
all_data <- data.frame()  # 用于存储所有文章的人口统计学和 RT 数据
gender_count_list <- list()  # 存储每篇文章的性别统计信息
age_data <- c()  # 存储所有年龄信息

# 遍历每篇文章的数据
for (i in 1:length(df)) {
  article_data <- df[[i]]  # 获取每篇文章的数据
  
  # 只选择我们关心的列，如 Gender、Age 和 RT_ms，其他的列忽略
  article_data_filtered <- article_data %>%
    select(any_of(c("Gender", "Age", "RT_ms")))  # 只选择这些列，如果不存在则忽略
  
  # 确保 Gender 列为字符类型，Age 列统一为数值类型
  if ("Gender" %in% colnames(article_data_filtered)) {
    article_data_filtered$Gender <- as.character(article_data_filtered$Gender)
  }
  
  if ("Age" %in% colnames(article_data_filtered)) {
    # 尝试将 Age 列转换为数值类型，非数值部分将变为 NA
    article_data_filtered$Age <- as.numeric(as.character(article_data_filtered$Age))
  }
  
  # 统计性别
  if ("Gender" %in% colnames(article_data_filtered)) {
    current_gender_count <- table(article_data_filtered$Gender)
    gender_count_list[[i]] <- current_gender_count
  }
  
  # 收集年龄数据
  if ("Age" %in% colnames(article_data_filtered)) {
    age_data <- c(age_data, article_data_filtered$Age)
  }
  
  # 将每篇文章的数据合并，只合并过滤后的数据
  all_data <- bind_rows(all_data, article_data_filtered)
}

# 合并所有文章的性别统计
if (length(gender_count_list) > 0) {
  all_genders <- Reduce(function(x, y) merge(as.data.frame(x), as.data.frame(y), by = "Var1", all = TRUE), gender_count_list)
  all_genders[is.na(all_genders)] <- 0
  gender_count <- rowSums(all_genders[, -1, drop = FALSE])
  names(gender_count) <- all_genders$Var1
} else {
  gender_count <- table()
}

# 人口统计学描述
total_subjects <- nrow(all_data)  # 被试总人数
male_count <- sum(all_data$Gender == "Male", na.rm = TRUE)  # 男性数量
female_count <- sum(all_data$Gender == "Female", na.rm = TRUE)  # 女性数量
avg_age <- mean(age_data, na.rm = TRUE)  # 平均年龄

# 输出人口统计学信息
cat("总被试量: ", total_subjects, "\n")
cat("男性数量: ", male_count, "\n")
cat("女性数量: ", female_count, "\n")
cat("平均年龄: ", avg_age, "\n")

# 对被试量进行分组
subject_bins <- cut(total_subjects, breaks = c(1, 10, 20, 40, 80, 160, Inf),
                    labels = c("1-10", "11-20", "21-40", "41-80", "81-160", "160以上"))

# 计算每个区间的被试数量
subject_distribution <- table(subject_bins)

# 将被试量数据转换为数据框
subject_df <- as.data.frame(subject_distribution)
colnames(subject_df) <- c("Range", "Count")

# 画出被试量比例的饼图
ggplot(subject_df, aes(x = "", y = Count, fill = Range)) +
  geom_bar(stat = "Origin_Identity", width = 1) +
  coord_polar("y", start = 0) +
  scale_fill_manual(values = colorRampPalette(c("yellow", "red"))(6)) +
  labs(title = "被试量分布比例") +
  theme_void()

# 如果有 RT_ms 数据，对其进行统计
if ("RT_ms" %in% colnames(all_data)) {
  rt_summary <- summary(all_data$RT_ms)
  cat("RT_ms 描述统计: \n")
  print(rt_summary)
}

```

## v3
```{r}
# 加载必要的库
library(dplyr)
library(ggplot2)

# 假设 df 是一个包含文章数据的列表，其中每个元素都是一个数据框
# df 是一个列表，df[[n]] 是第 n 篇文章，里面包含数据

# 定义一些变量来存储统计信息
all_data <- data.frame()  # 用于存储所有文章的人口统计学和 RT 数据
gender_count_list <- list()  # 存储每篇文章的性别统计信息
age_data <- c()  # 存储所有年龄信息

# 遍历每篇文章的数据
for (i in 1:length(df)) {
  article_data <- df[[i]]  # 获取每篇文章的数据
  
  # 只选择我们关心的列，如 Subject、Gender、Age 和 RT_ms，其他的列忽略
  article_data_filtered <- article_data %>%
    select(any_of(c("Subject", "Gender", "Age", "RT_ms")))  # 只选择这些列，如果不存在则忽略
  
  # 确保 Subject 列为字符类型，Gender 列为字符类型，Age 列统一为数值类型
  if ("Subject" %in% colnames(article_data_filtered)) {
    article_data_filtered$Subject <- as.character(article_data_filtered$Subject)
  }
  
  if ("Gender" %in% colnames(article_data_filtered)) {
    article_data_filtered$Gender <- as.character(article_data_filtered$Gender)
  }
  
  if ("Age" %in% colnames(article_data_filtered)) {
    article_data_filtered$Age <- as.numeric(as.character(article_data_filtered$Age))
  }
  
  # 为每篇文章中的被试编号添加文章索引前缀，使每个被试编号在全局范围内唯一
  article_data_filtered <- article_data_filtered %>%
    mutate(Subject = paste0("Article", i, "_", Subject))
  
  # 统计性别
  if ("Gender" %in% colnames(article_data_filtered)) {
    current_gender_count <- table(article_data_filtered$Gender)
    gender_count_list[[i]] <- current_gender_count
  }
  
  # 收集年龄数据
  if ("Age" %in% colnames(article_data_filtered)) {
    age_data <- c(age_data, article_data_filtered$Age)
  }
  
  # 将每篇文章的数据合并，只合并过滤后的数据
  all_data <- bind_rows(all_data, article_data_filtered)
}

# 合并所有文章的性别统计
gender_count <- Reduce(`+`, gender_count_list, init = table(factor(levels = unique(unlist(lapply(gender_count_list, names))))))

# 人口统计学描述
total_subjects <- nrow(all_data)  # 被试总人数
male_count <- sum(all_data$Gender == "Male", na.rm = TRUE)  # 男性数量
female_count <- sum(all_data$Gender == "Female", na.rm = TRUE)  # 女性数量
avg_age <- mean(age_data, na.rm = TRUE)  # 平均年龄

# 输出人口统计学信息
cat("总被试量: ", total_subjects, "\n")
cat("男性数量: ", male_count, "\n")
cat("女性数量: ", female_count, "\n")
cat("平均年龄: ", avg_age, "\n")

# 对被试量进行分组
subject_bins <- cut(total_subjects, breaks = c(1, 10, 20, 40, 80, 160, Inf),
                    labels = c("1-10", "11-20", "21-40", "41-80", "81-160", "160以上"))

# 计算每个区间的被试数量
subject_distribution <- table(subject_bins)

# 将被试量数据转换为数据框
subject_df <- as.data.frame(subject_distribution)
colnames(subject_df) <- c("Range", "Count")

# 画出被试量比例的饼图
ggplot(subject_df, aes(x = "", y = Count, fill = Range)) +
  geom_bar(stat = "Origin_Identity", width = 1) +
  coord_polar("y", start = 0) +
  scale_fill_manual(values = colorRampPalette(c("yellow", "red"))(6)) +
  labs(title = "被试量分布比例") +
  theme_void()

# 如果有 RT_ms 数据，对其进行统计
if ("RT_ms" %in% colnames(all_data)) {
  rt_summary <- summary(all_data$RT_ms)
  cat("RT_ms 描述统计: \n")
  print(rt_summary)
}
rm(subject_df,age_data,avg_age,current_gender_count,female_count,gender_count,i,male_count,rt_summary,subject_bins,subject_distribution,total_subjects,all_data,article_data,article_data_filtered,gender_count_list)
```

## v4
```{r}
# 加载必要的库
library(dplyr)
library(ggplot2)

# 假设 df 是一个包含文章数据的列表，其中每个元素都是一个数据框
# df 是一个列表，df[[n]] 是第 n 篇文章，里面包含数据

# 定义一些变量来存储统计信息
all_data <- data.frame()  # 用于存储所有文章的人口统计学和 RT 数据
gender_count_list <- list()  # 存储每篇文章的性别统计信息
age_data <- c()  # 存储所有年龄信息

# 遍历每篇文章的数据
for (i in 1:length(df)) {
  article_data <- df[[i]]  # 获取每篇文章的数据
  
  # 只选择我们关心的列，如 Subject、Gender、Age 和 RT_ms，其他的列忽略
  article_data_filtered <- article_data %>%
    select(any_of(c("Subject", "Gender", "Age", "RT_ms")))  # 只选择这些列，如果不存在则忽略
  
  # 确保 Subject 列为字符类型，Gender 列为字符类型，Age 列统一为数值类型
  if ("Subject" %in% colnames(article_data_filtered)) {
    article_data_filtered$Subject <- as.character(article_data_filtered$Subject)
  }
  
  if ("Gender" %in% colnames(article_data_filtered)) {
    article_data_filtered$Gender <- as.character(article_data_filtered$Gender)
  }
  
  if ("Age" %in% colnames(article_data_filtered)) {
    article_data_filtered$Age <- as.numeric(as.character(article_data_filtered$Age))
  }
  
  # 为每篇文章中的被试编号添加文章索引前缀，使每个被试编号在全局范围内唯一
  article_data_filtered <- article_data_filtered %>%
    mutate(Subject = paste0("Article", i, "_", Subject))
  
  # 统计性别
  if ("Gender" %in% colnames(article_data_filtered)) {
    current_gender_count <- table(article_data_filtered$Gender)
    gender_count_list[[i]] <- current_gender_count
  }
  
  # 收集年龄数据
  if ("Age" %in% colnames(article_data_filtered)) {
    age_data <- c(age_data, article_data_filtered$Age)
  }
  
  # 将每篇文章的数据合并，只合并过滤后的数据
  all_data <- bind_rows(all_data, article_data_filtered)
}

# 合并所有文章的性别统计
gender_count <- Reduce(`+`, gender_count_list, init = table(factor(levels = unique(unlist(lapply(gender_count_list, names))))))

# 人口统计学描述
total_subjects <- nrow(all_data)  # 被试总人数
male_count <- sum(all_data$Gender == "Male", na.rm = TRUE)  # 男性数量
female_count <- sum(all_data$Gender == "Female", na.rm = TRUE)  # 女性数量
avg_age <- mean(age_data, na.rm = TRUE)  # 平均年龄

# 输出人口统计学信息
cat("总被试量: ", total_subjects, "\n")
cat("男性数量: ", male_count, "\n")
cat("女性数量: ", female_count, "\n")
cat("平均年龄: ", avg_age, "\n")

# 分别绘制 Age 和 RT_ms 的散点图

# 绘制 Age 的散点图，X 轴为 Subject，Y 轴为 Age
ggplot(all_data, aes(x = Subject, y = Age, color = Gender)) +
  geom_point(alpha = 0.7) +
  labs(title = "Scatter Plot of Age by Subject",
       x = "Subject",
       y = "Age",
       color = "Gender") +
  theme_minimal() +
  theme(axis.text.x = element_blank())  # 隐藏 X 轴的文本

# 绘制 RT_ms 的散点图，X 轴为 Subject，Y 轴为 RT_ms
ggplot(all_data, aes(x = Subject, y = RT_ms, color = Gender)) +
  geom_point(alpha = 0.7) +
  labs(title = "Scatter Plot of RT_ms by Subject",
       x = "Subject",
       y = "RT_ms",
       color = "Gender") +
  theme_minimal() +
  theme(axis.text.x = element_blank())  # 隐藏 X 轴的文本

# 如果有 RT_ms 数据，对其进行统计
if ("RT_ms" %in% colnames(all_data)) {
  rt_summary <- summary(all_data$RT_ms)
  cat("RT_ms 描述统计: \n")
  print(rt_summary)
}

# 清理环境变量
rm(subject_df, age_data, avg_age, current_gender_count, female_count, gender_count, i, male_count, rt_summary, subject_bins, subject_distribution, total_subjects, all_data, article_data, article_data_filtered, gender_count_list)

```

## v5
```{r}
# 加载必要的库
library(dplyr)
library(ggplot2)

# 假设 df 是一个包含文章数据的列表，其中每个元素都是一个数据框
# df 是一个列表，df[[n]] 是第 n 篇文章，里面包含数据

# 定义一些变量来存储统计信息
all_data <- data.frame()  # 用于存储所有文章的人口统计学和 RT 数据
gender_count_list <- list()  # 存储每篇文章的性别统计信息
age_data <- c()  # 存储所有年龄信息

# 性别统一化函数
standardize_gender <- function(gender) {
  gender <- tolower(gender)  # 转换为小写
  if (gender %in% c("1", "m", "M", "Mann", "Hombre", "male", "Male")) {
    return("Male")
  } else if (gender %in% c("2", "f", "F", "Frau", "Mujer", "female", "Female")) {
    return("Female")
  } else {
    return("Others")
  }
}

# 遍历每篇文章的数据
for (i in 1:length(df)) {
  article_data <- df[[i]]  # 获取每篇文章的数据
  
  # 只选择我们关心的列，如 Subject、Gender、Age 和 RT_ms，其他的列忽略
  article_data_filtered <- article_data %>%
    select(any_of(c("Subject", "Gender", "Age", "RT_ms")))  # 只选择这些列，如果不存在则忽略
  
  # 确保 Subject 列为字符类型，Gender 列为字符类型，Age 列统一为数值类型
  if ("Subject" %in% colnames(article_data_filtered)) {
    article_data_filtered$Subject <- as.character(article_data_filtered$Subject)
  }
  
  if ("Gender" %in% colnames(article_data_filtered)) {
    article_data_filtered$Gender <- as.character(article_data_filtered$Gender)
    article_data_filtered$Gender <- sapply(article_data_filtered$Gender, standardize_gender)  # 统一化性别变量
  }
  
  if ("Age" %in% colnames(article_data_filtered)) {
    article_data_filtered$Age <- as.numeric(as.character(article_data_filtered$Age))
  }
  
  # 为每篇文章中的被试编号添加文章索引前缀，使每个被试编号在全局范围内唯一
  article_data_filtered <- article_data_filtered %>%
    mutate(Subject = paste0("Article", i, "_", Subject))
  
  # 统计性别
  if ("Gender" %in% colnames(article_data_filtered)) {
    current_gender_count <- table(article_data_filtered$Gender)
    gender_count_list[[i]] <- current_gender_count
  }
  
  # 收集年龄数据
  if ("Age" %in% colnames(article_data_filtered)) {
    age_data <- c(age_data, article_data_filtered$Age)
  }
  
  # 将每篇文章的数据合并，只合并过滤后的数据
  all_data <- bind_rows(all_data, article_data_filtered)
}

# 合并所有文章的性别统计
gender_count <- Reduce(`+`, gender_count_list, init = table(factor(levels = unique(unlist(lapply(gender_count_list, names))))))

# 人口统计学描述
total_subjects <- nrow(all_data)  # 被试总人数
male_count <- sum(all_data$Gender == "Male", na.rm = TRUE)  # 男性数量
female_count <- sum(all_data$Gender == "Female", na.rm = TRUE)  # 女性数量
avg_age <- mean(age_data, na.rm = TRUE)  # 平均年龄

# 输出人口统计学信息
cat("总被试量: ", total_subjects, "\n")
cat("男性数量: ", male_count, "\n")
cat("女性数量: ", female_count, "\n")
cat("平均年龄: ", avg_age, "\n")

# 分别绘制 Age 和 RT_ms 的散点图

# 绘制 Age 的散点图，X 轴为 Subject，Y 轴为 Age
ggplot(all_data, aes(x = Subject, y = Age, color = Gender)) +
  geom_point(alpha = 0.7) +
  labs(title = "Scatter Plot of Age by Subject",
       x = "Subject",
       y = "Age",
       color = "Gender") +
  theme_minimal() +
  theme(axis.text.x = element_blank())  # 隐藏 X 轴的文本

# 绘制 RT_ms 的散点图，X 轴为 Subject，Y 轴为 RT_ms
ggplot(all_data, aes(x = Subject, y = RT_ms, color = Gender)) +
  geom_point(alpha = 0.7) +
  labs(title = "Scatter Plot of RT_ms by Subject",
       x = "Subject",
       y = "RT_ms",
       color = "Gender") +
  theme_minimal() +
  theme(axis.text.x = element_blank())  # 隐藏 X 轴的文本

# 如果有 RT_ms 数据，对其进行统计
if ("RT_ms" %in% colnames(all_data)) {
  rt_summary <- summary(all_data$RT_ms)
  cat("RT_ms 描述统计: \n")
  print(rt_summary)
}

# 清理环境变量
rm(subject_df, age_data, avg_age, current_gender_count, female_count, gender_count, i, male_count, rt_summary, subject_bins, subject_distribution, total_subjects, all_data, article_data, article_data_filtered, gender_count_list)

```



